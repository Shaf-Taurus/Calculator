<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Trading Calculator | Pakistan</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    :root {
      --primary: #00695C;
      --primary-dark: #004D40;
      --primary-light: #4DB6AC;
      --secondary: #0288D1;
      --accent: #FF9800;
      --profit: #4CAF50;
      --loss: #F44336;
      --light: #F5F5F5;
      --dark: #263238;
      --gray: #607D8B;
      --border-radius: 16px;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    body {
      background: linear-gradient(135deg, #e0f7fa, #f1f8e9);
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header Styles */
    header {
      text-align: center;
      padding: 40px 20px 20px;
      background: linear-gradient(145deg, #00695C, #0288D1);
      border-radius: 0 0 var(--border-radius) var(--border-radius);
      color: white;
      margin-bottom: 40px;
      box-shadow: var(--shadow);
    }

    .logo-container {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 90px;
      height: 90px;
      background: white;
      border-radius: 50%;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
    }

    .logo-container i {
      font-size: 3rem;
      color: var(--primary);
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .subtitle {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto;
      opacity: 0.9;
    }

    /* Navigation */
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .nav-button {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 25px;
      background: white;
      color: var(--primary);
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      transition: var(--transition);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .nav-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 15px rgba(0, 105, 92, 0.2);
      background: var(--primary);
      color: white;
    }

    /* Calculator Styles */
    .calculator-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 40px;
    }

    @media (max-width: 900px) {
      .calculator-grid {
        grid-template-columns: 1fr;
      }
    }

    .section {
      background: white;
      border-radius: var(--border-radius);
      padding: 30px;
      box-shadow: var(--shadow);
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.5rem;
      color: var(--primary-dark);
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--primary-light);
    }

    .section-title i {
      color: var(--primary);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--dark);
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    label i {
      color: var(--primary);
      width: 24px;
      text-align: center;
    }

    input {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 1.1rem;
      transition: var(--transition);
      background: white;
      color: var(--dark);
      font-weight: 500;
    }

    input:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 4px rgba(0, 105, 92, 0.2);
    }

    .buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    button {
      flex: 1;
      padding: 16px;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button.primary {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
    }

    button.primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 14px rgba(0, 105, 92, 0.3);
    }

    button.secondary {
      background: white;
      color: var(--primary);
      border: 2px solid var(--primary);
    }

    button.secondary:hover {
      background: rgba(0, 113, 95, 0.05);
      transform: translateY(-3px);
    }

    .summary {
      background: white;
      border-radius: var(--border-radius);
      padding: 30px;
      box-shadow: var(--shadow);
      margin-bottom: 40px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }
    
    @media (max-width: 768px) {
      .summary {
        grid-template-columns: 1fr;
      }
    }

    .summary-left {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .summary-title {
      font-size: 1.8rem;
      color: var(--primary);
      margin-bottom: 20px;
      text-align: center;
    }

    .summary-value {
      font-size: 2.5rem;
      font-weight: 700;
      text-align: center;
      margin: 20px 0;
    }

    .roi-percentage {
      font-size: 1.8rem;
      font-weight: 700;
      text-align: center;
      margin: 10px 0 20px;
    }

    .summary-label {
      text-align: center;
      color: var(--gray);
      font-size: 1.1rem;
      margin-bottom: 10px;
    }
    
    .roi-container {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
    
    .roi-value {
      background: var(--light);
      padding: 12px 25px;
      border-radius: 30px;
      font-weight: 700;
      font-size: 1.3rem;
    }

    .summary-right {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .chart-container {
      width: 100%;
      max-width: 300px;
      position: relative;
    }
    
    .chart-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }
    
    .chart-center-value {
      font-size: 1.8rem;
      font-weight: 700;
    }
    
    .chart-center-label {
      font-size: 1rem;
      color: var(--gray);
    }

    .disclaimer {
      background: rgba(255, 152, 0, 0.1);
      border-left: 4px solid var(--accent);
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
      font-size: 1rem;
    }

    .disclaimer h3 {
      color: var(--accent);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    footer {
      background: linear-gradient(to right, var(--primary-dark), var(--primary));
      color: white;
      padding: 40px 20px;
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      text-align: center;
    }

    .footer-content {
      max-width: 800px;
      margin: 0 auto;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .footer-links a:hover {
      color: var(--accent);
      transform: translateY(-3px);
    }

    .copyright {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Responsive Design */
    @media (max-width: 600px) {
      .section {
        padding: 20px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .section-title {
        font-size: 1.3rem;
      }
      
      .buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-container">
      <i class="fas fa-chart-candlestick"></i>
    </div>
    <h1>Stock Trading Calculator</h1>
    <p class="subtitle">Calculate your stock trading profits with all fees included</p>
    
    <div class="nav-buttons">
      <a href="index.html" class="nav-button">
        <i class="fas fa-home"></i> Home
      </a>
      <a href="sip_calculator.html" class="nav-button">
        <i class="fas fa-chart-line"></i> SIP Calculator
      </a>
      <a href="inflation_calculator.html" class="nav-button">
        <i class="fas fa-money-bill-wave"></i> Inflation Calculator
      </a>
    </div>
  </header>
  
  <div class="container">
    <div class="calculator-grid">
      <div class="section">
        <h2 class="section-title"><i class="fas fa-shopping-cart"></i> Buy Section</h2>
        
        <div class="form-group">
          <label for="buyQty"><i class="fas fa-box"></i> Quantity</label>
          <input id="buyQty" type="number" value="100">
        </div>
        
        <div class="form-group">
          <label for="buyRate"><i class="fas fa-tag"></i> Buy Rate (PKR)</label>
          <input id="buyRate" type="number" value="64.5">
        </div>
        
        <div class="form-group">
          <label for="buyGross"><i class="fas fa-money-bill"></i> Gross Amount</label>
          <input id="buyGross" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyIDS"><i class="fas fa-file-invoice"></i> NCCPL - IDS Fee</label>
          <input id="buyIDS" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyRMS"><i class="fas fa-file-invoice-dollar"></i> NCCPL - RMS Fee</label>
          <input id="buyRMS" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyBroker"><i class="fas fa-hand-holding-usd"></i> Broker Commission</label>
          <input id="buyBroker" readonly>
        </div>
        
        <div class="form-group">
          <label for="buySalesTax"><i class="fas fa-percentage"></i> Sales Tax on Brokerage</label>
          <input id="buySalesTax" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyDSS"><i class="fas fa-file-contract"></i> DSS Fee</label>
          <input id="buyDSS" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyTotalFee"><i class="fas fa-calculator"></i> Total Fee</label>
          <input id="buyTotalFee" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyTotalCost"><i class="fas fa-wallet"></i> Total Cost</label>
          <input id="buyTotalCost" readonly>
        </div>
        
        <div class="form-group">
          <label for="buyActualRate"><i class="fas fa-tags"></i> Actual Rate</label>
          <input id="buyActualRate" readonly>
        </div>
        
        <div class="buttons">
          <button class="primary" id="calculate-buy-btn">
            <i class="fas fa-calculator"></i> Calculate Buy
          </button>
        </div>
      </div>
      
      <div class="section">
        <h2 class="section-title"><i class="fas fa-cash-register"></i> Sell Section</h2>
        
        <div class="form-group">
          <label for="sellQty"><i class="fas fa-box"></i> Quantity</label>
          <input id="sellQty" type="number" value="100">
        </div>
        
        <div class="form-group">
          <label for="sellRate"><i class="fas fa-tag"></i> Sell Rate (PKR)</label>
          <input id="sellRate" type="number" value="66">
        </div>
        
        <div class="form-group">
          <label for="sellGross"><i class="fas fa-money-bill"></i> Gross Amount</label>
          <input id="sellGross" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellIDS"><i class="fas fa-file-invoice"></i> NCCPL - IDS Fee</label>
          <input id="sellIDS" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellRMS"><i class="fas fa-file-invoice-dollar"></i> NCCPL - RMS Fee</label>
          <input id="sellRMS" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellBroker"><i class="fas fa-hand-holding-usd"></i> Broker Commission</label>
          <input id="sellBroker" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellSalesTax"><i class="fas fa-percentage"></i> Sales Tax on Brokerage</label>
          <input id="sellSalesTax" readonly>
        </div>
        
        <div class="form-group">
          <label for="capitalGain"><i class="fas fa-chart-line"></i> Capital Gain Tax</label>
          <input id="capitalGain" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellTotalFee"><i class="fas fa-calculator"></i> Total Fee</label>
          <input id="sellTotalFee" readonly>
        </div>
        
        <div class="form-group">
          <label for="sellNetAmount"><i class="fas fa-coins"></i> Net Amount</label>
          <input id="sellNetAmount" readonly>
        </div>
        
        <div class="form-group">
          <label for="netPL"><i class="fas fa-balance-scale"></i> Net P/L</label>
          <input id="netPL" readonly>
        </div>
        
        <div class="buttons">
          <button class="primary" id="calculate-sell-btn">
            <i class="fas fa-calculator"></i> Calculate Sell
          </button>
        </div>
      </div>
    </div>
    
    <div class="summary">
      <div class="summary-left">
        <h2 class="summary-title">Profit/Loss Summary</h2>
        <div class="summary-value" id="netPLSummary">₨ 0.00</div>
        <div class="roi-percentage" id="roiPercentage">0.00%</div>
        <p class="summary-label">Net Profit/Loss after all fees and taxes</p>
        
        <div class="roi-container">
          <div class="roi-value" id="roiValue">ROI: 0.00%</div>
        </div>
      </div>
      
      <div class="summary-right">
        <div class="chart-container">
          <canvas id="roiChart"></canvas>
          <div class="chart-center">
            <div class="chart-center-value" id="chartValue">0.00%</div>
            <div class="chart-center-label">ROI</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="disclaimer">
      <h3><i class="fas fa-exclamation-triangle"></i> Trading Disclaimer</h3>
      <p>This calculator provides estimates based on standard fees and taxes in Pakistan. Actual fees may vary based on your broker and current regulations. Stock trading involves risks, and past performance is not indicative of future results. Consult with a financial advisor before making investment decisions.</p>
    </div>
  </div>
  
  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="index.html"><i class="fas fa-home"></i> Home</a>
        <a href="sip_calculator.html"><i class="fas fa-chart-line"></i> SIP Calculator</a>
        <a href="inflation_calculator.html"><i class="fas fa-money-bill-wave"></i> Inflation Calculator</a>
        <a href="stock_calculator.html"><i class="fas fa-chart-candlestick"></i> Stock Calculator</a>
      </div>
      
      <div class="copyright">
        <p>© 2023 Financial Calculators Pakistan. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Chart instance
    let roiChart = null;
    
    // Calculate buy costs
    function calculateBuy() {
      const qty = parseFloat(document.getElementById("buyQty").value);
      const rate = parseFloat(document.getElementById("buyRate").value);
      const gross = qty * rate;
      const ids = 1.61;
      const rms = 0.32;
      const broker = gross * 0.0015;
      const tax = broker * 0.13;
      const dss = 5.65;
      const totalFee = ids + rms + broker + tax + dss;
      const totalCost = gross + totalFee;
      const actualRate = totalCost / qty;

      document.getElementById("buyGross").value = gross.toFixed(2);
      document.getElementById("buyIDS").value = ids.toFixed(2);
      document.getElementById("buyRMS").value = rms.toFixed(2);
      document.getElementById("buyBroker").value = broker.toFixed(2);
      document.getElementById("buySalesTax").value = tax.toFixed(3);
      document.getElementById("buyDSS").value = dss.toFixed(2);
      document.getElementById("buyTotalFee").value = totalFee.toFixed(2);
      document.getElementById("buyTotalCost").value = totalCost.toFixed(2);
      document.getElementById("buyActualRate").value = actualRate.toFixed(2);
      
      return totalCost;
    }

    // Calculate sell profits
    function calculateSell() {
      const qty = parseFloat(document.getElementById("sellQty").value);
      const rate = parseFloat(document.getElementById("sellRate").value);
      const buyRate = parseFloat(document.getElementById("buyRate").value);
      const buyTotalCost = parseFloat(document.getElementById("buyTotalCost").value) || 0;
      const gross = qty * rate;
      const ids = 1.65;
      const rms = 0.33;
      const broker = gross * 0.0015;
      const tax = broker * 0.13;
      const cgt = Math.max(0, (rate - buyRate) * qty * 0.15);
      const totalFee = ids + rms + broker + tax + cgt;
      const netAmount = gross - totalFee;
      const netPL = netAmount - buyTotalCost;
      
      // Calculate ROI
      let roiPercentage = 0;
      if (buyTotalCost > 0) {
        roiPercentage = (netPL / buyTotalCost) * 100;
      }

      document.getElementById("sellGross").value = gross.toFixed(2);
      document.getElementById("sellIDS").value = ids.toFixed(2);
      document.getElementById("sellRMS").value = rms.toFixed(2);
      document.getElementById("sellBroker").value = broker.toFixed(2);
      document.getElementById("sellSalesTax").value = tax.toFixed(3);
      document.getElementById("capitalGain").value = cgt.toFixed(2);
      document.getElementById("sellTotalFee").value = totalFee.toFixed(2);
      document.getElementById("sellNetAmount").value = netAmount.toFixed(2);
      document.getElementById("netPL").value = netPL.toFixed(2);
      
      // Update summary
      document.getElementById("netPLSummary").textContent = '₨ ' + netPL.toFixed(2);
      document.getElementById("roiPercentage").textContent = roiPercentage.toFixed(2) + '%';
      document.getElementById("roiValue").textContent = 'ROI: ' + roiPercentage.toFixed(2) + '%';
      document.getElementById("chartValue").textContent = roiPercentage.toFixed(2) + '%';
      
      // Update ROI chart
      updateRoiChart(roiPercentage, netPL);
      
      return { netPL, roiPercentage };
    }
    
    // Update ROI chart
    function updateRoiChart(roiPercentage, netPL) {
      const ctx = document.getElementById('roiChart').getContext('2d');
      
      // Destroy existing chart if it exists
      if (roiChart) {
        roiChart.destroy();
      }
      
      // Determine chart colors based on profit/loss
      const backgroundColor = netPL >= 0 ? ['#4CAF50', '#e0e0e0'] : ['#F44336', '#e0e0e0'];
      const roiValue = Math.min(Math.abs(roiPercentage), 100);
      const remaining = 100 - roiValue;
      
      roiChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          datasets: [{
            data: [roiValue, remaining],
            backgroundColor: backgroundColor,
            borderWidth: 0,
            circumference: 360
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '70%',
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              enabled: false
            }
          },
          animation: {
            animateRotate: true,
            animateScale: true
          }
        }
      });
      
      // Set text color based on profit/loss
      document.getElementById("chartValue").style.color = netPL >= 0 ? '#4CAF50' : '#F44336';
      document.getElementById("roiPercentage").style.color = netPL >= 0 ? '#4CAF50' : '#F44336';
      document.getElementById("netPLSummary").style.color = netPL >= 0 ? '#4CAF50' : '#F44336';
    }

    // Initialize event listeners
    document.getElementById("calculate-buy-btn").addEventListener("click", function() {
      calculateBuy();
      calculateSell();
    });
    
    document.getElementById("calculate-sell-btn").addEventListener("click", function() {
      calculateSell();
    });

    // Input event listeners for real-time updates
    document.getElementById("buyQty").addEventListener("input", function() {
      document.getElementById("sellQty").value = this.value;
      calculateBuy();
      calculateSell();
    });
    
    document.getElementById("buyRate").addEventListener("input", function() {
      calculateBuy();
      calculateSell();
    });
    
    document.getElementById("sellQty").addEventListener("input", function() {
      document.getElementById("buyQty").value = this.value;
      calculateBuy();
      calculateSell();
    });
    
    document.getElementById("sellRate").addEventListener("input", function() {
      calculateSell();
    });

    // Initial calculations
    window.onload = function() {
      calculateBuy();
      calculateSell();
    };
  </script>
</body>
</html>